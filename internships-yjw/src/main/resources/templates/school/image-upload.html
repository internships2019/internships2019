<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>添加企业</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <link rel="stylesheet" th:href="@{/css/font.css}" href="./css/font.css">
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}" href="./css/xadmin.css">
    <script th:src="@{/layui/layui.js}" src="layui/layui.js" charset="utf-8"></script>
</head>
<body style="margin: 20px;">

    <div class="layui-upload" style="margin-left: 30px">
        <div class="layui-upload-list">
            <button type="button" class="layui-btn" id="test1" style="margin-top: 20px">选择图片</button>
            <button type="button" class="layui-btn" id="test2" style="margin-top: 20px">上传</button>
            <br>
            <img style="width: 100px;height: 120px;margin-top: 10px;margin-left: 40px;"  class="layui-upload-img" id="demo1">
            <p id="demoText"></p>
        </div>
    </div>
<script>
        function child(user){
            console.log(user)
            layui.use(['layer','jquery','upload'],function () {
                var form=layui.form;
                var layer=layui.layer;
                var $=layui.jquery;
                var upload=layui.upload;

                upload.render({
                    elem: '#test1'
                    ,url: '/internships/waitInsertInfo/upload_image'
                    ,auto: false
                    ,bindAction: '#test2'
                    ,data:{id:user.id}
                    ,choose:function (obj) {
                        obj.preview(function(index, file, result){
                            $('#demo1').attr('src', result); //图片链接（base64）
                        });
                    }
                    ,before: function(obj){ //obj参数包含的信息，跟 choose回调完全一致，可参见上文。
                        layer.msg('照片上传中', {
                            icon: 16
                            ,shade: 0.01
                        });
                    }
                    , done: function(res, index, upload){
                        console.log(res);
                        if (res.code=='1'){
                            parent.callData=res.data;
                            layer.alert("照片更换成功！",{icon:1},function () {
                                var index = parent.layer.getFrameIndex(window.name);//关闭当前弹出层
                                parent.layer.close(index);//执行弹出层关闭
                            });
                        }else {
                            layer.msg("照片上传失败!",{icon:2});
                        }
                    }
                });
            });
        };
    </script>
</body>
</html>